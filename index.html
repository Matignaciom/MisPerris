<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ferretería Don Pepe</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        .foto-producto {
            width: 50px;
            height: 50px;
        }
    </style>
</head>
<body>
    <div class="container mt-5 mb-5">
        <h2 class="text-center">Ferretería Don Pepe</h2>
        <br>
        <div class="row">
            <div class="col-md-6">
                <h3 class="text-center">Productos y detalles</h3>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Producto</th>
                                <th>Precio</th>
                                <th>Stock</th>
                                <th>Foto</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>Clavos</td>
                                <td>$50</td>
                                <td><span id="stock-clavos">200</span></td>
                                <td><img src="/recursos/Clavos.png" class="foto-producto" alt="Clavos"></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>Pernos</td>
                                <td>$150</td>
                                <td><span id="stock-pernos">150</span></td>
                                <td><img src="/recursos/Pernos.png" class="foto-producto" alt="Pernos"></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>Tuercas</td>
                                <td>$150</td>
                                <td><span id="stock-tuercas">130</span></td>
                                <td><img src="/recursos/Tuercas.png" class="foto-producto" alt="Tuercas"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-md-6">
                <h3 class="text-center">Estado de pago</h3>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Edad</th>
                            </tr>
                        </thead>
                        <tbody id="estado-pago-body">
                            <tr>
                                <td>...</td>
                                <td>...</td>
                            </tr>
                        </tbody>
                    </table>
                
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Productos</th>
                                <th>Cantidad</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody id="productos-body">
                            <tr>
                                <td>Clavos</td>
                                <td>0</td>
                                <td>$0</td>
                            </tr>
                            <tr>
                                <td>Pernos</td>
                                <td>0</td>
                                <td>$0</td>
                            </tr>
                            <tr>
                                <td>Tuercas</td>
                                <td>0</td>
                                <td>$0</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td><strong>Totales</strong></td>
                                <td id="total-cantidad">0</td>
                                <td id="total">$0</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            
        </div>
        <div class="row mt-3">
            <div class="col-md-6">
                <form id="formulario-pago">
                    <div class="form-group">
                        <label for="nombre">Ingrese su nombre:</label>
                        <input type="text" class="form-control" id="nombre" placeholder="Nombre" pattern=".{2,}" title="El nombre debe tener al menos 2 caracteres" required>
                    </div>
                    <div class="form-group">
                        <label for="edad">Ingrese su edad:</label>
                        <input type="number" class="form-control" id="edad" placeholder="Edad" min="18" required>
                    </div>
                    <div class="form-group">
                        <label for="clavos">Cantidad de Clavos:</label>
                        <input type="number" class="form-control" id="clavos" placeholder="Clavos" min="0" max="200" required>
                    </div>
                    <div class="form-group">
                        <label for="pernos">Cantidad de Pernos:</label>
                        <input type="number" class="form-control" id="pernos" placeholder="Pernos" min="0" max="150" required>
                    </div>
                    <div class="form-group">
                        <label for="tuercas">Cantidad de Tuercas:</label>
                        <input type="number" class="form-control" id="tuercas" placeholder="Tuercas" min="0" max="130" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Total a pagar</button>
                </form>                        
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
        $(document).ready(function(){
            $('#formulario-pago').submit(function(e){
                e.preventDefault();
                var nombre = $('#nombre').val();
                var edad = $('#edad').val();
                var clavos = $('#clavos').val();
                var pernos = $('#pernos').val();
                var tuercas = $('#tuercas').val();
                
                // Validar nombre
                if(nombre.length < 2){
                    alert('El nombre debe tener al menos 2 caracteres');
                    return;
                }
                
                // Validar edad
                if(edad < 18){
                    alert('La edad debe ser mayor o igual a 18 años');
                    return;
                }
                
                // Validar cantidad de clavos
                if(clavos > 200 || clavos < 0){
                    alert('La cantidad de clavos no puede ser mayor que el stock disponible');
                    return;
                }
                
                // Validar cantidad de pernos
                if(pernos > 150 || pernos < 0){
                    alert('La cantidad de pernos no puede ser mayor que el stock disponible');
                    return;
                }
                
                // Validar cantidad de tuercas
                if(tuercas > 130 || tuercas < 0){
                    alert('La cantidad de tuercas no puede ser mayor que el stock disponible');
                    return;
                }
                
                // Calcular total de cada producto
                var totalClavos = clavos * 50;
                var totalPernos = pernos * 150;
                var totalTuercas = tuercas * 150;
                
                // Calcular total general
                var total = totalClavos + totalPernos + totalTuercas;
                var totalCantidad = parseInt(clavos) + parseInt(pernos) + parseInt(tuercas);
                
                // Actualizar tabla de estado de pago
                $('#estado-pago-body').html('<tr><td>' + nombre + '</td><td>' + edad + '</td></tr>');
                
                // Actualizar tabla de productos
                $('#productos-body').html('<tr><td>Clavos</td><td>' + clavos + '</td><td>$' + totalClavos + '</td></tr><tr><td>Pernos</td><td>' + pernos + '</td><td>$' + totalPernos + '</td></tr><tr><td>Tuercas</td><td>' + tuercas + '</td><td>$' + totalTuercas + '</td></tr>');
                
                // Actualizar totales
                $('#total-cantidad').text(totalCantidad);
                $('#total').text('$' + total);
                
                // Actualizar stock de productos
                var stockClavos = 200 - clavos;
                var stockPernos = 150 - pernos;
                var stockTuercas = 130 - tuercas;
                
                $('#stock-clavos').text(stockClavos);
                $('#stock-pernos').text(stockPernos);
                $('#stock-tuercas').text(stockTuercas);
                
                // Limpiar formulario
                $('#nombre').val('');
                $('#edad').val('');
                $('#clavos').val('');
                $('#pernos').val('');
                $('#tuercas').val('');
            });
        });
    </script>
</body>
</html>
